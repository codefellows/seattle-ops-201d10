# Challenge - Powershell Logs

Today we're practicing the Get-EventLog commandlet in Powershell.

## Demo Code

# Get event logs on the local computer

`Get-EventLog -List`

- `Get-EventLog`: This is a PowerShell cmdlet used to retrieve event log entries from a specified event log. However, when used with the `-List` parameter, it behaves differently. Instead of returning event log entries, it retrieves a list of available event logs.
- `-List`: This is a parameter for the `Get-EventLog` cmdlet. When you use `-List`, it instructs the cmdlet to retrieve a list of all the available event logs on the system rather than returning event log entries.


# Get recent entries from an event log on the local computer

`Get-EventLog -LogName System -Newest 5`

- `Get-EventLog`: This is a PowerShell cmdlet used to retrieve event log entries from a specified event log. In this case, the cmdlet will access the "System" event log.
- `-LogName`: This is a parameter for the `Get-EventLog` cmdlet. It specifies the name of the event log from which you want to retrieve the event entries. In this code, we are using the value "System" to access the "System" event log.
- `-Newest`: This is another parameter for the `Get-EventLog` cmdlet. It specifies the number of most recent event log entries to retrieve. In this code, we are using the value "5" to retrieve the five most recent entries.


# Find all sources for a specific number of entries in an event log

`$Events = Get-EventLog -LogName System -Newest 1000`
`$Events | Group-Object -Property Source -NoElement | Sort-Object -Property Count -Descending`

- `$Events = Get-EventLog -LogName System -Newest 1000`:
This line retrieves the 1000 most recent event log entries from the "System" event log on the local computer. The result is stored in the variable `$Events`, which will hold an array of event log entries.
- `$Events | Group-Object -Property Source -NoElement`:
This line uses the `Group-Object` cmdlet to group the event log entries stored in the `$Events` variable based on the "Source" property. It creates separate groups for each unique source value, and the `-NoElement` parameter ensures that the output only contains the group names (source names) and the count of items in each group.
- Remember, in PowerShell, the pipe symbol `|` is known as the "pipe" operator, and it is used to pass the output of one cmdlet or command as input to another cmdlet or command. It allows you to chain multiple commands together, creating a pipeline of data processing.
- `Sort-Object -Property Count -Descending`:
This line uses the `Sort-Object` cmdlet to sort the grouped event log entries based on the "Count" property in descending order. The "Count" property represents the number of items in each group, which is essentially the number of event log entries for each unique source. The `-Descending` parameter ensures that the groups with the highest count (most occurrences) are listed first.


# Get error events from a specific event log

`Get-EventLog -LogName System -EntryType Error`

- `Get-EventLog`: This is a PowerShell cmdlet used to retrieve event log entries from a specified event log. In this case, the cmdlet will access the "System" event log.
- `-LogName`: This is a parameter for the `Get-EventLog` cmdlet. It specifies the name of the event log from which you want to retrieve the event entries. In this code, we are using the value "System" to access the "System" event log.
- `-EntryType`: This is another parameter for the `Get-EventLog` cmdlet. It filters the event log entries based on their entry type. In this code, we are using the value "Error" to filter and retrieve only those event entries that have an "Error" entry type.


# Get events from an event log using a source and event ID

`Get-EventLog -LogName Application -Source Outlook | Where-Object {$_.EventID -eq 63} | Select-Object -Property Source, EventID, InstanceId, Message`

- `Get-EventLog -LogName Application -Source Outlook`:
This line uses the `Get-EventLog` cmdlet to retrieve event log entries from the "Application" event log on the local computer. The `-LogName` parameter specifies the event log to query ("Application" in this case), and the `-Source` parameter filters the events to only those generated by "Outlook."
- `Where-Object {$_.EventID -eq 63}`:
This line uses the `Where-Object` cmdlet (also represented by the alias Where) to filter the event log entries obtained in the previous step. The script block `{ $_.EventID -eq 63 }` checks each event's "EventID" property and only includes those events where the "EventID" is equal to 63.
- `Select-Object -Property Source, EventID, InstanceId, Message`:
This line uses the `Select-Object` cmdlet to choose and display specific properties from the filtered event log entries. The `-Property` parameter specifies the properties to be included in the output. In this case, the code selects "Source," "EventID," "InstanceId," and "Message" properties.
